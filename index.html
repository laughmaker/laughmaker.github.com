
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>闻竹</title>
  <meta name="author" content="laughmaker">

  
  <meta name="description" content="    Spec Repo是所有的Pods的一个索引，就是一个容器，承载所有公开或私有的的Pods项目源引用，仅保存每个pod库的引用。     公共的Spec Repo是一个Git仓库remote端，在GitHub上，但是当你使用了Cocoapods后他会被clone到本地的\~/. &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://laughmaker.github.io">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="闻竹" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!-- <link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'> -->
  

</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">闻竹</a></h1>
  
    <h2>于车马喧哗中守一份宁静      于万马齐喑中持一片热忱</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:laughmaker.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">主页</a></li>
  <li><a href="/blog/archives">文章归档</a></li>
  <li><a href="/about">关于我</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/09/20/shi-yong-podsguan-li-xiang-mu/">使用pods管理项目</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-09-20T21:46:15+08:00" pubdate data-updated="true">Sep 20<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>    Spec Repo是所有的Pods的一个索引，就是一个容器，承载所有公开或私有的的Pods项目源引用，仅保存每个pod库的引用。</p>

<p>    公共的Spec Repo是一个Git仓库remote端，在GitHub上，但是当你使用了Cocoapods后他会被clone到本地的\~/.cocoapods/repos目录下，这个master目录的结构是这个样子的</p>

<pre><code>├── Specs
    └── [SPEC_NAME]
        └── [VERSION]
            └── [SPEC_NAME].podspec 备注：运行 `pod repo` 命令，可以查看所有的pod仓库，然后进入到列出来的目录，可查看相关仓库的目录结构 **一、创建私有的Spec Repo**
</code></pre>

<p>1.首先在托管服务器上创建一个仓库。<br />
2.然后将托管服务器中的仓库与本地pod repo关联：  </p>

<pre><code># pod repo add [Private Repo Name] [GitHub HTTPS clone URL]
pod repo add TWSpecs https://git.coding.net/laughmaker/TWSpecs.git
</code></pre>

<p>备注：此处TWSpecs名可以随便取，只是取在你本地的一个命名，作为与远端相关联的一个名称。</p>

<p>备注：若别人需要使用这个私有项目里的代码，需要有单个项目和这个仓库的权限才能使用</p>

<p><strong>二、创建私有模块项目，并创建podspec文件</strong></p>

<p>1.创建一个包含私有代码的项目，并将代码上传到托管服务器<br />
2.在根目录下，运行以下命令创建podspec文件  </p>

<pre><code>pod spec create PodTestLibrary git@coding.net:wtlucky/podTestLibrary.git
</code></pre>

<p>备注：由于此步骤会创建一个完整的配置文件，里面包含许多用不到的配置信息和注释，故可以拷贝其他项目的配置文件来做相应修改，简化操作。另此配置文件，应保持简洁，不需要的注释和信息，最好删除掉。</p>

<p><strong>三、配置验证podspec文件</strong></p>

<p>创建成功后，会在根目录下产生一个.podspec文件，按提示中，填入相应信息后，输入以下命令，进行验证：</p>

<pre><code>pod lib lint
</code></pre>

<p>若成功会提示passed validation.否则按提示进行错误改正。</p>

<p><strong>四、本地测试</strong></p>

<p>创建一个新的项目，在这个项目的Podfile文件中直接指定刚才创建编辑好的podspec文件，看是否可用。 在Podfile中我们可以这样编辑，有两种方式</p>

<pre><code>platform :ios, '7.0'

pod 'PodTestLibrary', :path =&gt; '~/code/Cocoapods/podTest/PodTestLibrary'      #指定路径
pod 'PodTestLibrary', :podspec =&gt; '~/code/Cocoapods/podTest/PodTestLibrary/PodTestLibrary.podspec'  #指定podspec文件
</code></pre>

<p>然后执行pod install命令安装依赖，在项目工程中，可以看到pod库安装在Development Pods/PodTestLibrary中。</p>

<p>在项目中编写代码，测试库文件无误后就可以开始下一步了，提交podspec到Spec Repo中。</p>

<p><strong>五、将私有项目提交到本地Spec Repo中</strong></p>

<p>向私有Spec Repo提交podspec只需要一个命令</p>

<pre><code>pod repo push TWSpecs PodTestLibrary.podspec  #前面是本地Repo名字 后面是podspec名字
</code></pre>

<p>成功之后这个组件库就添加到我们的私有Spec Repo中了，可以进入到\~/.cocoapods/repos/TWSpecs目录下查看</p>

<p>再去看我们的Spec Repo远端仓库，也有了一次提交，这个podspec也已经被Push上去了。</p>

<p><strong>六、更新维护私有项目</strong></p>

<p>更新维护将对应的版本一起更新即可，注意，对应tag版本号一定要一致。</p>

<p><strong>七、使用私有项目</strong></p>

<pre><code>source 'https://git.coding.net/laughmaker/TWSpecs.git'  
source 'https://github.com/CocoaPods/Specs.git'  

pod 'TWSNS',:git=&gt;"http://xxxxx.git"
</code></pre>

<p>备注：私有库和公有库的源都需要添加，否则只能搜到其中的一个代码。</p>

<p><strong>八、删除私有库</strong></p>

<pre><code>pod repo remove TWSpecs
</code></pre>

<p><strong>九、部署到公有库</strong></p>

<p>代码创建好了，当然也可以提交到公有库了，之前需要审核一两天的时间，而现在有了trunk，提交即可使用了。</p>

<p>1.首先将代码上传到github。</p>

<p>2.注册trunk服务</p>

<pre><code>pod trunk register wskrdfeai@gmail.com 'laughmaker' --description='我爱我的因我觉得欢喜' --verbose
</code></pre>

<p>可查看注册信息：</p>

<pre><code>pod trunk me
</code></pre>

<p>3.将仓库上传到公有库中心</p>

<pre><code>pod trunk push TWSNS.podspec
</code></pre>

<p>4.也可以将其他人添加进来一起进行开发</p>

<pre><code>pod trunk add-owner ProjectName(项目名) email(要添加进来的人)
</code></pre>

<p>以上步骤，可能会稍微慢一些，因为这些操作，都会和github打交道。成功之后，其他人更新pod索引库，即可搜索和使用你刚才添加的项目了。</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/03/19/yii2ipbnote/">Yii2学习笔记</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-03-19T15:02:54+08:00" pubdate data-updated="true">Mar 19<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>一、安装</p>

<p>1.安装composer</p>

<pre><code>brew install composer
</code></pre>

<p>详细教程见：<a href="http://www.phpcomposer.com">composer官网</a></p>

<p>添加<a href="http://pkg.phpcomposer.com">中国镜像</a>：<br />
修改/user/username/.composer/config.json文件，将相应内容改为如下：</p>

<pre><code>"repositories":[
     {"type": "composer", "url":"http://pkg.phpcomposer.com/repo/packagist/"},
     {"packagist":false}
]
</code></pre>

<p>添加前端资源管理器<code>composer-asset</code></p>

<pre><code>composer global require "fxp/composer-asset-plugin:1.0.0"
</code></pre>

<p>2.安装Yii</p>

<p>安装Yii2高级版，应用名称为：www.3water3.com</p>

<pre><code>composer  create-project --prefer-dist yiisoft/yii2-app-advanced www.3water3.com
</code></pre>

<p>二、配置框架</p>

<p>默认安装完成后，有两个应用：<code>frontend</code>和<code>backend</code>，还需要添加一个<code>api</code>应用，提供app应用接口。</p>

<p>1.复制backend目录到当前目录，修改名字为api</p>

<pre><code>cp -r backend api
</code></pre>

<p>2.修改配置，支持api应用，打开environments目录下的index.php文件，添加api部分修改后如下所示：</p>

<pre><code>return [
    'Development' =&gt; [
        'path' =&gt; 'dev',
        'setWritable' =&gt; [
            'backend/runtime',
            'backend/web/assets',
            'backend/models',
            'backend/views',
            'backend/controllers',
            'frontend/runtime',
            'frontend/web/assets',
	         'frontend/models',
            'frontend/views',
            'frontend/controllers',
            'api/runtime',
            'api/web/assets',
            'api/models',
            'api/views',
            'api/controllers',
        ],
        'setExecutable' =&gt; [
            'yii',
        ],
        'setCookieValidationKey' =&gt; [
            'backend/config/main-local.php',
            'frontend/config/main-local.php',
            'api/config/main-local.php',
        ],
    ],
    'Production' =&gt; [
        'path' =&gt; 'prod',
        'setWritable' =&gt; [
            'backend/runtime',
            'backend/web/assets',
            'frontend/runtime',
            'frontend/web/assets',
            'api/runtime',
            'api/web/assets',
        ],
        'setExecutable' =&gt; [
            'yii',
        ],
        'setCookieValidationKey' =&gt; [
            'backend/config/main-local.php',
            'frontend/config/main-local.php',
            'api/config/main-local.php',
        ],
    ],
];
</code></pre>

<p>分别进入www.3water3.com/environments/dev和prod目录，复制backend为api</p>

<pre><code>cp -r backend api
</code></pre>

<p>3.在根目录下，运行初始化命令</p>

<pre><code>./init
</code></pre>

<p>根据需求，选择开发环境和产品环境。至此，项目框架搭建完成。</p>

<p>三、配置与使用Mysql数据库</p>

<p>1.创建一个测试数据库，进入mysql命令行终端：</p>

<pre><code>create database dev;
</code></pre>

<p>2.创建<code>hzd</code>用户，密码为<code>hZd</code>，权限为dev数据库下所所有操作</p>

<pre><code>grant all privileges on dev.* to hzd@localhost identified by 'hZd';
</code></pre>

<p>3.修改common/config/main-local.php文件，添加数据库连接信息，分别修改dbname、username、password为以上创建的对应内容。</p>

<p>4.创建数据库中相应的表，使用migrate来创建。以user表为例：</p>

<p>进入console/migrations目录，修改init.php文件，将其中的up、down分别修改为safeUp、safeDown。</p>

<p>运行数据库迁移命令：</p>

<pre><code>./yii migrate/up
</code></pre>

<p>以上则可创建数据表，./yii migrate/down则可删除user表。</p>

<p>四、设置局域网域名</p>

<p>五、RUL美化</p>

<p>1.打开common/config/bootstrap.php文件，在文件下面添加一行</p>

<pre><code>Yii::setAlias('api', dirname(dirname(__DIR__)) . '/api');
</code></pre>

<p>2.修改api/config/main.php文件中内容为如下：</p>

<pre><code>return [
    'id' =&gt; 'app-api',
    'basePath' =&gt; dirname(__DIR__),
    'controllerNamespace' =&gt; 'api\controllers',
    'bootstrap' =&gt; ['log'],
    'modules' =&gt; [],
    'components' =&gt; [
        'user' =&gt; [
            'identityClass' =&gt; 'common\models\User',
            'enableAutoLogin' =&gt; true,
        ],
        'log' =&gt; [
            'traceLevel' =&gt; YII_DEBUG ? 3 : 0,
            'targets' =&gt; [
                [
                    'class' =&gt; 'yii\log\FileTarget',
                    'levels' =&gt; ['error', 'warning'],
                ],
            ],
        ],
        'errorHandler' =&gt; [
            'errorAction' =&gt; 'site/error',
        ],
        'urlManager' =&gt; [
            'enablePrettyUrl' =&gt; true,
            'enableStrictParsing' =&gt; true,
            'showScriptName' =&gt; false,
            'rules' =&gt; [
                ['class' =&gt; 'yii\rest\urlRule', 'controller' =&gt; ['section', 'comment', 'user']],
            ],
        ],
    ],
    'params' =&gt; $params,
];
</code></pre>

<p>六、添加Mongo扩展</p>

<p><strong>附录</strong>：<br />
1.<a href="http://www.yiiframework.com/doc-2.0/ext-mongodb-index.html">Mongo扩展资料</a><br />
2.<a href="http://www.yiiframework.com/doc-2.0/index.html">Yii2官方API文档</a><br />
3.<a href="http://www.yiichina.com">官方中文网</a><br />
4.<a href="http://www.digpage.com">深入理解Yii2.0</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/03/02/2015/">2015，新的一年，加油！</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-03-02T17:19:20+08:00" pubdate data-updated="true">Mar 2<span>nd</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>　　休息了三个月，也自由了三个月，从身体到精神，都放松了，身体发了福，精神上虽然也长了杂草，却也有几根青苗在萌芽。</p>

<p>　　以前一直渴望的自由，也降临了，却突然发觉生活失去了规律，时光在散漫中消磨，日复一日。  </p>

<p>　　以前一直以为自由，就是想干什么，就干什么，想不干什么，就不干什么。慢慢的发觉，其实错了，有一句名言说“<code>人是生而自由的，但无往不在枷锁之中，自以为是其他一切主人的人，反而比其他一切更是奴隶。</code>”。其实只有自律，才会有自由; 当一个人缺乏自律的时候，他做的事情，总是在受习惯和即时诱惑的影响，要么就是被他人的思想观念所扰，几乎永远不可能去做内心真正渴望去做的事。　　</p>

<p>　　我们总是给自己借口，万事皆可明日重来，但很少意识到，时光，就在这样年复一年的明日之中流失而一去不复返，如诗所云：
&gt;明日复明日，明日何其多，此生复明日，万事成蹉跎。</p>

<p>　　从明天起，做一个热爱生活的人，每天都有很强大的起床的动力，每天都按时起床、吃饭、睡觉，用心去拥抱每个时刻，珍惜美好的人与物，自律而自由的生活。</p>

<p>　　<strong><code>早上</code></strong><br />
　　7:00-7:15　　起床<br />
　　7:15-8:00　　阅读，学习新的知识<br />
　　8:00-8:30　　吃早餐<br />
　　8:30-11:30　 编程(包括看技术资料)</p>

<p>　　<strong><code>中午</code></strong><br />
　　11:30-12:00　午餐<br />
　　12:00-13:00　午休</p>

<p>　　<strong><code>下午</code></strong><br />
　　13:00-17:30  编程(包括看技术资料)<br />
　　17:30-20:00  晚餐、运动、娱乐</p>

<p>　　<strong><code>晚上</code></strong><br />
　　20:00-23:00  编程(包括看技术资料)<br />
　　23:00-24:00  阅读非技术书籍、睡前反思总结</p>

<p>　　如此分配，可保证充足的休息时间(8h)、工作量(10h)和补充新知识(1h 45m)，也可以睡前反思总结一天得失，当不至于荒废时光。</p>

<p>　　如有特殊情况，致使中断，适当运动娱乐时间或从餐饮时间中抽减补充，以保证工作和学习时间。</p>

<p>　　2015，新的一年，新的机遇，<strong>把握、加油</strong>！
　　</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/02/11/macxia-pei-zhi-nginx-plus-php-plus-mongohuan-jing/">Mac下配置nginx+php+mongo环境</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-11T17:30:09+08:00" pubdate data-updated="true">Feb 11<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h4 id="brew">安装brew</h4>

<p>安装：</p>

<pre><code>curl -LsSf http://github.com/mxcl/homebrew/tarball/master | sudo tar xvz -C/usr/local --strip 1
</code></pre>

<p>brew安装的软件目录：</p>

<pre><code>/usr/local/Cellar
</code></pre>

<p>常用命令：</p>

<ul>
  <li>更新brew：brew update</li>
  <li>更新所有brew安装的软件：brew upgrade</li>
  <li>查看所有brew安装的软件：brew list</li>
  <li>搜索具体的程序包：brew search mysql</li>
  <li>安装具体的程序包：brew install mysql</li>
  <li>查看具体程序的信息：brew info mysql</li>
  <li>卸载具体的应用：brew uninstall mysql</li>
</ul>

<hr />

<h4 id="pecl">安装pecl</h4>

<pre><code>cd /usr/lib/php 
sudo php install-pear-nozlib.phar 
sudo pear channel-update pear.php.net 
sudo pecl channel-update pecl.php.net 
sudo pear upgrade-all
</code></pre>

<hr />

<h4 id="mongo">安装mongo</h4>

<p>安装</p>

<pre><code>brew install mongodb
</code></pre>

<p>创建/data/db文件夹，启动数据库需要</p>

<pre><code>sudo mkdir -p /data/db
</code></pre>

<p>启动数据库</p>

<pre><code>sudo mongod
</code></pre>

<p>命令行启动mongo操作终端(非必须)</p>

<pre><code>sudo mongo
</code></pre>

<p>停止数据库</p>

<pre><code>sudo pkill mongo
</code></pre>

<hr />

<h4 id="php">配置php</h4>

<p>由于mac自带有php，故直接使用系统自带的php</p>

<p>启动,若提示无相关文件，则创建相关文件再启动</p>

<pre><code>sudo php-fpm
</code></pre>

<p>配置文件路径</p>

<pre><code>/etc/php.ini
</code></pre>

<p>若无该配置文件，则创建该文件</p>

<pre><code>sudo mv /etc/php.ini.default /etc/php.ini
</code></pre>

<p>php扩展路径</p>

<pre><code>/usr/lib/php/extensions/
</code></pre>

<hr />

<h4 id="phpmongo">配置php的mongo扩展</h4>

<p>安装</p>

<pre><code>sudo pecl install mongo
</code></pre>

<p>如果安装失败，出现如下错误：</p>

<pre><code>1 error generated.
make: *** [php_mongo.lo] Error 1
ERROR: `make' failed
</code></pre>

<p>则可能是未安装命令行开发工具，安装之：</p>

<pre><code>xcode-select --install
</code></pre>

<p>若出现如下错误，则有可能是openssl版本不够导致：</p>

<pre><code>make: *** [io_stream.lo] Error 1
ERROR: `make' failed
</code></pre>

<p>更新openssl版本即可，若还不够，则升级为开发者版。</p>

<p>安装完毕，在/etc/php.ini文档中最后添加</p>

<pre><code>extension=mongo.so
</code></pre>

<p>详细文档</p>

<p><a href="http://docs.mongodb.org/ecosystem/drivers/php/">PHP MongoDB Driver</a></p>

<hr />

<h4 id="nginx">安装nginx</h4>

<p>安装</p>

<pre><code>brew install nginx
</code></pre>

<p>启动</p>

<pre><code>sudo nginx
</code></pre>

<p>配置文件路径</p>

<pre><code>/usr/local/etc/nginx/nginx.conf
</code></pre>

<p>页面访问目录</p>

<pre><code>/usr/local/var/www
</code></pre>

<p>nginx常用命令</p>

<pre><code>nginx -V 查看版本，以及配置文件地址  
nginx -v 查看版本  
nginx -c filename 指定配置文件  
nginx -h 帮助  
nginx -s [reload\reopen\stop\quit]
</code></pre>

<p>详细配置教程</p>

<p><a href="http://oilbeater.com/nginx/2014/12/29/nginx-conf-from-zero.html">nginx配置从零开始</a></p>

<hr />

<h4 id="nginxphp">配置nginx支持php文件</h4>

<p>打开配置文档</p>

<p>sudo vim /usr/local/etc/nginx/nginx.conf</p>

<p>将监听端口更改80</p>

<pre><code>server {
        listen       80;
        server_name  localhost;
</code></pre>

<p>添加php解析支持，取消注释，并更改文件目录为/usr/local/var/www</p>

<pre><code>location ~ \.php$ {
            root           /usr/local/var/www;
            fastcgi_pass   127.0.0.1:9000;
            fastcgi_index  index.php;
            fastcgi_param  SCRIPT_FILENAME  /usr/local/var/www$fastcgi_script_name;
            include        fastcgi_params;
        }
</code></pre>

<p><a href="http://huoding.com/2013/10/23/290">如何正确的配置nginx+php</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/02/11/macxia-pei-zhi-webhuan-jing/">Mac下配置web环境</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-11T17:26:29+08:00" pubdate data-updated="true">Feb 11<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3 id="phpjs">配置PHP和JS调试环境</h3>
<ul>
  <li>点击tools -&gt; build system -&gt; new build system</li>
  <li>
    <p>在其中输入如下代码，保存为PHP.sublime-build </p>

    <pre><code>  {
      "cmd": ["php", "$file"],
      "file_regex": "^(...*?):([0-9]*):?([0-9]*)",
      "selector": "source.php"
  }
</code></pre>
  </li>
  <li>此后，即可用command+B进行编译调试了</li>
</ul>

<p>另外，添加一个new build system，命名为JSC.sublime-build，添加以下内容，即可调试js代码：</p>

<pre><code>{
	"cmd": ["/System/Library/Frameworks/JavaScriptCore.framework/Versions/A/Resources/jsc", "$file"],
	"selector": "source.js"
}
</code></pre>

<hr />

<h3 id="xdebug">配置Xdebug</h3>

<h4 id="xdebug-1">安装xdebug</h4>

<p>选择一个xdebug版本</p>

<ul>
  <li>brew search xdebug</li>
</ul>

<p>安装xdebug</p>

<ul>
  <li>brew install php55-xdebug</li>
</ul>

<p>将以下代码片断加入到php.ini文件最后</p>

<pre><code>zend_extension= "/usr/lib/php/extensions/no-debug-non-zts-20121212/xdebug.so"
xdebug.default_enable = On
xdebug.show_exception_trace = On
xdebug.show_local_vars = 1
xdebug.max_nesting_level = 50
xdebug.var_display_max_depth = 6

xdebug.dump_once = On
xdebug.dump_globals = On
xdebug.dump_undefined = On
xdebug.dump.REQUEST = *
xdebug.cli_color = 2
</code></pre>

<p><strong>以下为配置sublime</strong></p>

<p>将项目保存为一个project</p>

<ul>
  <li>
    <p>sublime-&gt;project-&gt;save project as…</p>
  </li>
  <li>
    <p>利用package control 安装xdebug client</p>
  </li>
</ul>

<p>配置项目</p>

<ul>
  <li>sublime-&gt;project-&gt;edit project</li>
</ul>

<p>在其中添加类似以下内容</p>

<pre><code>{
    "folders":
    [
        {
            "follow_symlinks": true,
            "path": "."
        }
    ],
    "settings": {
        "xdebug": {
             "url": "http://my.local.website/",
        }
    }
}
</code></pre>

<p>开启调试，在项目文件中添加断点</p>

<ul>
  <li>xdebug-&gt;Add/Remove breakpoint</li>
</ul>

<p>进行调试</p>

<pre><code>tools-&gt;xdebug-&gt;start debugging(launch browser)
</code></pre>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/02/11/phpbian-cheng-gui-fan/">PHP编程规范</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-11T17:18:09+08:00" pubdate data-updated="true">Feb 11<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h4 id="php">PHP命名规范</h4>

<ol>
  <li>类文件都是以“<strong>.class.php</strong>“为后缀，且类文件名只允许字母，使用驼峰法命名，并且首字母大写，例如：DbMysql.class.php 。</li>
  <li>配置和函数等其他类库文件之外的文件一般是分别以“.inc.php“和”.php“为后缀，且文件名命名使用小写字母和下划线的方式，多个单词之间以下 划线分隔，例如config.inc.php ， common.php，install_function.php 。</li>
  <li>确保文件的命名和调用大小写一致，是由于在类Unix系统上面，对大小写是敏感的。</li>
  <li>类名和文件名一致（包括上面说的大小写一致），且类名只允许字母，例如 UserAction类的文件命名是UserAction.class.php， InfoModel类的文件名是InfoModel.class.php 。</li>
  <li>控制器类以Action为后缀，例如 UserAction、InfoAction ，模型类以Model为后缀，例如UserModel、InfoModel ，其他类也分别以相应分类为后缀，例如Service 、Widget。</li>
  <li>方法名只允许由字母组成，下划线是不允许的，首字母要小写，其后每个单词首字母要大写，即所谓的 “驼峰法命名” 规则，且越详细越好，应该能够描述清楚该方法的功能，例如switchModel、findPage。</li>
  <li>属性的命名只允许由字母组成，下划线是不允许的，首字母要小写，其后每个单词首字母要大写，即所谓的 “驼峰法命名” 规则，例如tablePrefix、tableName 。</li>
  <li>
    <p>对于对象成员的访问，我们必须始终使用 “get” 和 “set” 方法。例如：  </p>

    <pre><code> class Foo
 {
     protected $_testObj;
     public function getTestObj()
	
     {
         return $this-&gt;_testObj;
     }
     public function setTestObj($testObj)
     {
         $this-&gt;testObj = $_testObj;
     }
 }
</code></pre>
  </li>
  <li>
    <p>当类成员方法被声明为 private 时，必须分别以双下划线 “<em>_“为开头；被声明为 protected 时，必须分别以单下划线 “</em>” 为开头；一般情况下的方法不含下划线。例如 ：</p>

    <pre><code> class Foo
 {
     private function __example()
     {
         // ...
     }
     protected function _example()
     {
         // ...
     }
     public function example()
     {
         // ...
     }
 }
</code></pre>
  </li>
  <li>
    <p>如果我们需要把一些经常使用的方法定义为全局函数，那么应该把它们以静态 (static) 的形式定义在类中。例如：</p>

    <pre><code>class Think
{
    // ...
    static public function autoload($classname)
    {
        // ...
    }
}
</code></pre>
  </li>
  <li>被声明为 private的类成员属性必须由双下划线 “<em>_” 作为开头；被声明为 protected 的类成员属性必须由下划线 “</em>” 作为开头；而声明为 public 的成员属性则在任何时候都不允许含有下划线。</li>
  <li>函数的命名使用小写字母和下划线的方式，且越详细越好，应该能够描述清楚该函数的功能，例如 get_client_ip 。</li>
  <li>当方法或函数参数不一定需要被赋值的时候，用 “null” 来代替 “false” 作为函数参数的默认值，除非该参数是 boolean 值。</li>
  <li>变量只允许由小写字母和下划线组成，且建议用描述性的变量的命名，越详细越好，以至于像 $i 或 $n 等等都是不鼓励使用的。</li>
  <li>类中的常量 constant 和全局范围内常量define，只能由大写字母和下划线组成，各个单词之间以下划线分割。</li>
  <li>boolean 值和 null 值都采用小写。</li>
</ol>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/02/11/zheng-ze-biao-da-shi-jian-dan-shuo-ming/">正则表达式简单说明</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-11T17:16:22+08:00" pubdate data-updated="true">Feb 11<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong>常用元字符</strong></p>

<pre><code>代码	说明
.	匹配除换行符以外的任意字符
\w	匹配字母或数字或下划线或汉字
\s	匹配任意的空白符
\d	匹配数字
\b	匹配单词的开始或结束
^	匹配字符串的开始
$	匹配字符串的结束
</code></pre>

<p><strong>常用限定符</strong></p>

<pre><code>代码/语法	说明
*	重复零次或更多次
+	重复一次或更多次
?	重复零次或一次
{n}	重复n次
{n,}	重复n次或更多次
{n,m}	重复n到m次
</code></pre>

<p><strong>常用反义词</strong></p>

<pre><code>代码/语法	说明
\W	匹配任意不是字母，数字，下划线，汉字的字符
\S	匹配任意不是空白符的字符
\D	匹配任意非数字的字符
\B	匹配不是单词开头或结束的位置
[^x]	匹配除了x以外的任意字符
[^aeiou]	匹配除了aeiou这几个字母以外的任意字符
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/02/11/macxia-an-zhuang-pei-zhi-mysql/">Mac下安装配置mysql</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-11T17:00:22+08:00" pubdate data-updated="true">Feb 11<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2 id="macmysql">mac下安装配置mysql</h2>

<p>1.安装：</p>

<pre><code>brew install mysql
</code></pre>

<p>2.添加修改mysql配置<br />
运行：</p>

<pre><code>mysqld --help --verbose | more  
</code></pre>

<p>查看这一行：</p>

<pre><code>  Default options are read from the following files in the given order:
/etc/my.cnf /etc/mysql/my.cnf /usr/local/etc/my.cnf ~/.my.cnf
</code></pre>

<p>创建连接和配置文件：</p>

<pre><code>ls $(brew --prefix mysql)/support-files/my-* (用这个可以找到样例.cnf)
cp /usr/local/opt/mysql/support-files/my-default.cnf /etc/my.cnf (拷贝到第一个默认读取目录)
</code></pre>

<p>3.解决mysql_connect():No such file or director错误</p>

<p>启动mysql后,如果/tmp/mysql.sock文件存在，/var/mysql/mysql.sock不存在，则运行：</p>

<pre><code>cd /var
sudo mkdir mysql
cd mysql
sudo ln -s /tmp/mysql.sock mysql.sock
</code></pre>

<p>3.启动与停止</p>

<pre><code>mysql.server start
mysql.server stop
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/01/04/mongodbchang-yong-cao-zuo/">Mongodb常用操作</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-01-04T15:56:30+08:00" pubdate data-updated="true">Jan 4<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><hr />

<p>PHP对MongoDB的扩展文档地址：http://us3.php.net/manual/en/book.mongo.php</p>

<pre><code>在PHP的Mongo扩展中，有4类接口对象：  
1.针对MongoDB的连接的操作：MongoClient
http://us3.php.net/manual/en/class.mongoclient.php
2.针对MongoDB中数据库的操作：MongoDB
http://us3.php.net/manual/en/book.mongo.php
3.针对MongoDB中的Collection的操作：MongoCollection
http://us3.php.net/manual/en/class.mongocollection.php
4.针对查询结果集的操作：MongoCursor和MongoCommandCursor
http://us3.php.net/manual/en/class.mongocursor.php
http://us3.php.net/manual/en/class.mongocommandcursor.php
</code></pre>

<hr />

<h4 id="section">常用管理命令</h4>
<pre><code>./mongo	#启动Mongo Shell
use foo	#进入数据库foo
db.createUser({user:'hzdRW', pwd:'hezhendong', roles:[{role:'dbOwner', db:'hzdDB'}]} #添加用户或修改用户密码
db.system.users.find()	#查看用户列表
db.auth('name', 'pwd')	#用户认证
db.removeUser('name')	#删除用户
show users	#查看所有用户
show dbs	#查看所有数据库
show collectios  #查看所有的collection
db.printCollectionStats()	#查看各collection的状态
db.printReplicationInfo()	#查看主从复制状态
db.repariDatabase()	 #修复数据库
db.copyDatabase(fromDB, toDB, fromHost[, username, password])  #拷贝数据库
db.collection_name.drop()  #删除集合
db.dropDatabase()  #删除当前数据库
db.shutdownServer() #关闭当前服务程序
exit #退出当前shel
</code></pre>

<hr />

<h4 id="section-1">数据库连接</h4>
<p>1.默认连接本机的27017端口 </p>

<pre><code>$mongo = new MongoClient();
</code></pre>

<p>2.自定义格式连接，一般ip为本机可写为localhost,port可省略  </p>

<pre><code>格式：$mongo = new MongoClient('mongodb://username:password@ip:port');  
</code></pre>

<hr />

<h4 id="section-2">查询</h4>
<p>1.find findOne findAndModify</p>

<ul>
  <li>
    <p>查询user集合中全部内容：</p>

    <pre><code>  db.user.find();
</code></pre>
  </li>
  <li>
    <p>查询user集合中age的值为27的文档：</p>

    <pre><code>  db.user.find({"age":27});
</code></pre>
  </li>
  <li>
    <p>查询user集合中age为27,username为joe的内容：</p>

    <pre><code>  db.user.find({"age":27, "username":27});
</code></pre>
  </li>
  <li>
    <p>查询user集合中的所有内容，但只返回username和email键的值：</p>

    <pre><code>  db.user.find({}, {"username":1, "email":1});
</code></pre>
  </li>
  <li>
    <p>查询user集合中的所有内容，但剔除age键：</p>

    <pre><code>  db.user.find({}, {"age": 0});
</code></pre>
  </li>
  <li>
    <p>查询user集合中的age为18的第一条记录：</p>

    <pre><code>  db.user.findOne({"age":18});
</code></pre>
  </li>
  <li>
    <p>根据查询条件找到相应的记录并对一条结果做更新操作，其中query为查询条件，sort指定排序，remove表示删除（remove和update不能同时指定），new表示返回更新之前还是之后的结果，这条命令只能返回一条结果</p>

    <pre><code>  db.user.findAndModify({"query":{"username":"joe"}, "sort":{"age":1}, "remove":true, "new":true});
</code></pre>
  </li>
</ul>

<p>2.查询操作符</p>

<pre><code>$lt(&lt;) $lte(&lt;=) $gt(&gt;=) $gte(&gt;=) 
$in(匹配一个键的多个值) $nin(与列出来的所有值都不匹配)
$all:匹配数组中所有元素，模糊匹配，不关注顺序
$not:反向匹配
$size:匹配数组长度
</code></pre>

<ul>
  <li>
    <p>查询age在18～30(含)岁之间的用户：</p>

    <pre><code>  db.user.find({"age":{"$gte":18, "$lte":30}});
</code></pre>
  </li>
  <li>
    <p>查询age为18、20、22岁的用户：</p>

    <pre><code>  db.user.find({"age":{"$in":[18, 20, 22]}});
</code></pre>
  </li>
  <li>
    <p>查询age不为18、20、22岁的所有用户：</p>

    <pre><code>  db.user.find({"age":{"$nin":[18, 20, 22]}});
</code></pre>
  </li>
  <li>
    <p>查询username不为joe的所有用户：</p>

    <pre><code>  db.user.find({"username":{"$not":"joe"}});
</code></pre>
  </li>
</ul>

<p>3.$exists<br />
判断字段是否存在</p>

<ul>
  <li>
    <p>查询所有存在username字段的记录：</p>

    <pre><code>  db.user.find({"username":{"$exsits":true}});
</code></pre>
  </li>
  <li>
    <p>查询所有不存在username字段的记录：</p>

    <pre><code>  db.user.find({"username":{"$exsits":false}});
</code></pre>
  </li>
</ul>

<p>4.$slice<br />
返回数组的一个子集合</p>

<ul>
  <li>
    <p>查询user集合中username为joe的前10个用户：</p>

    <pre><code>  db.user.find({"username":"joe"}, {"$slice": 10});
</code></pre>
  </li>
  <li>
    <p>查询user集合中从第21条记录开始的10条记录：</p>

    <pre><code>  db.user.find({"username":"joe"}, {"$slice":[20, 10]});
</code></pre>
  </li>
</ul>

<p>5.对结果排序  </p>

<ul>
  <li>对年龄升序：db.user.find().sort({“age”:1});</li>
  <li>对年龄降序：db.user.find().sort({“age”:-1});</li>
</ul>

<p>6.限制返回数据条数  </p>

<ul>
  <li>返回5条记录:db.user.find().limit(5)</li>
  <li>从第3条记录开始，返回5条记录:db.user.find().skip(3).limit(5)</li>
  <li>返回记录条数:db.user.find().count()</li>
  <li>返回限制条件后的记录数量:db.user.find().skip(10).limit(5).count(1)</li>
</ul>

<hr />

<h4 id="section-3">插入、更新、删除</h4>
<p><code>insert save update remove</code><br />
若存在_id主键，insert()不做操作，且提示错误，save()改变原来的内容为新内容。</p>

<p><strong>修改器</strong>:</p>

<pre><code>$set:修改字段
$unset:删除字段，不论对目标键使用1、0、-1或者具体的字符串等都是可以删除该目标键。
$rename:修改字段字
$push、pushAll:向数组末尾追加数据，字段不存在则创建
$addToSet:向数组类型乐加数据时避免重复
$each:遍历数组
$pop:从数组中删除数据，{"$pop":{key:1}}从末尾删除，-1从头部删除
$pull和$pullAll:从数组中删除指定数据
</code></pre>

<ul>
  <li>
    <p>向user集合中插入单个文档：</p>

    <pre><code>  db.user.insert({"username":"joe", "age":18});
</code></pre>
  </li>
  <li>
    <p>清空user集合：</p>

    <pre><code>  db.user.remove();
</code></pre>
  </li>
  <li>
    <p>清除user集合中所有age为18的数据：</p>

    <pre><code>  db.user.remove({"age":18});
</code></pre>
  </li>
  <li>
    <p>根据query条件修改，如果不存在则插入，物许修改多条记录：</p>

    <pre><code>  db.foo.update({"y":1}, {"$set":{"x":2}}, upsert=true, multi=true);
</code></pre>
  </li>
  <li>
    <p>找到username为joe的记录，并删除email字段：</p>

    <pre><code>  db.user.update({"username":"joe"}, {"$unset":{"email":1}});
</code></pre>
  </li>
  <li>
    <p>修改username为nickname:</p>

    <pre><code>  db.user.update({}, {"$rename":{"username":"nickname"}});
</code></pre>
  </li>
</ul>

<hr />

<h4 id="section-4">修改器详解示例</h4>

<pre><code>对于文档的更新除替换外，针对某个或多个文档只需要部分更新可使用原子的更新修改器，能够高效的进行文档更新。更新修改器是中特殊的键， 用来指定复杂的操作，比如增加、删除或者调整键，还可能是操作数组或者内嵌文档。
</code></pre>

<p>1.$inc</p>

<p>$inc可以对文档的某个值为数字型（只能为满足要求的数字）的键进行增减的操作。</p>

<pre><code>示例文档：{"uid":"201203","type":"1",size:10}
&gt; db.b.insert({"uid":"201203","type":"1",size:10})
&gt; db.b.find()
{ "_id" : ObjectId("5003b6135af21ff428dafbe6"), "uid" : "201203", "type" : "1",
"size" : 10 }
&gt; db.b.update({"uid" : "201203"},{"$inc":{"size" : 1}})
&gt; db.b.find()
{ "_id" : ObjectId("5003b6135af21ff428dafbe6"), "uid" : "201203", "type" : "1",
"size" : 11 }
&gt; db.b.update({"uid" : "201203"},{"$inc":{"size" : 2}})
&gt; db.b.find()
{ "_id" : ObjectId("5003b6135af21ff428dafbe6"), "uid" : "201203", "type" : "1",
"size" : 13 }
&gt; db.b.update({"uid" : "201203"},{"$inc":{"size" : -1}})
&gt; db.b.find()
{ "_id" : ObjectId("5003b6135af21ff428dafbe6"), "uid" : "201203", "type" : "1",
"size" : 12 }
</code></pre>

<p>2.$set</p>

<p>用来指定一个键并更新键值，若键不存在并创建，对于内嵌文档在使用$set更新时，使用”.”连接的方式。</p>

<pre><code>&gt; db.a.findOne({"uid" : "20120002","type" : "3"})
{ "_id" : ObjectId("500216de81b954b6161a7d8f"), "desc" : "hello world2!", "num"
: 40, "sname" : "jk", "type" : "3", "uid" : "20120002" }
</code></pre>

<p>–size键不存在的场合</p>

<pre><code>&gt; db.a.update({"uid" : "20120002","type" : "3"},{"$set":{"size":10}})
&gt; db.a.findOne({"uid" : "20120002","type" : "3"})
{ "_id" : ObjectId("500216de81b954b6161a7d8f"), "desc" : "hello world2!", "num"
: 40, "size" : 10, "sname" : "jk", "type" : "3", "uid" : "20120002" }
</code></pre>

<p>–sname键存在的场合</p>

<pre><code>&gt; db.a.update({"uid" : "20120002","type" : "3"},{"$set":{"sname":"ssk"}})
&gt; db.a.find()
{ "_id" : ObjectId("500216de81b954b6161a7d8f"), "desc" : "hello world2!", "num"
: 40, "size" : 10, "sname" : "ssk", "type" : "3", "uid" : "20120002" }
{ "_id" : ObjectId("50026affdeb4fa8d154f8572"), "desc" : "hello world1!", "num"
: 50, "sname" : "jk", "type" : "1", "uid" : "20120002" }
</code></pre>

<p>–可改变键的值类型</p>

<pre><code>&gt; db.a.update({"uid" : "20120002","type" : "3"},{"$set":{"sname":["java",".net","c++"]}})
&gt; db.a.findOne({"uid" : "20120002","type" : "3"})
{
        "_id" : ObjectId("500216de81b954b6161a7d8f"),
        "desc" : "hello world2!",
        "num" : 40,
        "size" : 10,
        "sname" : [
                "java",
                ".net",
                "c++"
        ],
        "type" : "3",
        "uid" : "20120002"
}
</code></pre>

<p>对于内嵌的文档，$set又是如何进行更新的内嵌的文档的呢，请看下面的示例：</p>

<pre><code>示例文档：{"name":"toyota","type":"suv","size":{"height":10,"width":5,"length":15}}
&gt; db.c.findOne({"name":"toyota"})
{
        "_id" : ObjectId("5003be465af21ff428dafbe7"),
        "name" : "toyota",
        "type" : "suv",
        "size" : {
                "height" : 10,
                "width" : 5,
                "length" : 15
        }
}
&gt; db.c.update({"name":"toyota"},{"$set":{"size.height":8}})
&gt; db.c.findOne({"name":"toyota"})
{
        "_id" : ObjectId("5003be465af21ff428dafbe7"),
        "name" : "toyota",
        "type" : "suv",
        "size" : {
                "height" : 8,
                "width" : 5,
                "length" : 15
        }
}
&gt; db.c.update({"name":"toyota"},{"$set":{"size.width":7}})
&gt; db.c.findOne({"name":"toyota"})
{
        "_id" : ObjectId("5003be465af21ff428dafbe7"),
        "name" : "toyota",
        "type" : "suv",
        "size" : {
                "height" : 8,
                "width" : 7,
                "length" : 15
        }
}
</code></pre>

<p>3.$unset</p>

<p>从字面就可以看出其意义，主要是用来删除键。
使用修改器$unset时，不论对目标键使用1、0、-1或者具体的字符串等都是可以删除该目标键。</p>

<pre><code>示例操作效果如下：
&gt; db.a.update({"uid" : "20120002","type" : "3"},{"$unset":{"sname":1}})
&gt; db.a.findOne({"uid" : "20120002","type" : "3"})
{
        "_id" : ObjectId("500216de81b954b6161a7d8f"),
        "desc" : "hello world2!",
        "num" : 40,
        "size" : 10,
        "type" : "3",
        "uid" : "20120002"
}
&gt; db.a.update({"uid" : "20120002","type" : "3"},{"$unset":{"num":0}})
&gt; db.a.findOne({"uid" : "20120002","type" : "3"})
{
        "_id" : ObjectId("500216de81b954b6161a7d8f"),
        "desc" : "hello world2!",
        "size" : 10,
        "type" : "3",
        "uid" : "20120002"
}
&gt; db.a.update({"uid" : "20120002","type" : "3"},{"$unset":{"size":-1}})
&gt; db.a.findOne({"uid" : "20120002","type" : "3"})
{
        "_id" : ObjectId("500216de81b954b6161a7d8f"),
        "desc" : "hello world2!",
        "type" : "3",
        "uid" : "20120002"
}
&gt; db.a.update({"uid" : "20120002","type" : "3"},{"$unset":{"desc":"sssssss"}})
&gt; db.a.findOne({"uid" : "20120002","type" : "3"})
{
        "_id" : ObjectId("500216de81b954b6161a7d8f"),
        "type" : "3",
        "uid" : "20120002"
}
</code></pre>

<p>4.数组修改器–$push</p>

<p>$push–向文档的某个数组类型的键添加一个数组元素，不过滤重复的数据。添加时键存在，要求键值类型必须是数组；键不存在，则创建数组类型的键。</p>

<p>示例操作效果如下：</p>

<pre><code>&gt; db.c.find()
{ "_id" : ObjectId("5003be465af21ff428dafbe7"), "name" : "toyota", "type" : "suv",
"size" : { "height" : 8, "width" : 7, "length" : 15 } }
</code></pre>

<p>先push一个当前文档中不存在的键title</p>

<pre><code>&gt; db.c.update({"name" : "toyota"},{$push:{"title":"t1"}})
&gt; db.c.find()
{ "_id" : ObjectId("5003be465af21ff428dafbe7"), "name" : "toyota", "size" : { "height" : 8,
 "width" : 7, "length" : 15 }, "title" : [ "t1" ], "type" : "suv" }
</code></pre>

<p>再向title中push一个值</p>

<pre><code>&gt; db.c.update({"name" : "toyota"},{$push:{"title":"t2"}})
&gt; db.c.find()
{ "_id" : ObjectId("5003be465af21ff428dafbe7"), "name" : "toyota", "size" : { "height" : 8,
 "width" : 7, "length" : 15 }, "title" : [ "t1", "t2" ], "type" : "suv" }
</code></pre>

<p>再向title中push一个值</p>

<pre><code>&gt; db.c.update({"name" : "toyota"},{$push:{"title":"t2"}})
&gt; db.c.find()
{ "_id" : ObjectId("5003be465af21ff428dafbe7"), "name" : "toyota", "size" : { "height" : 8,
 "width" : 7, "length" : 15 }, "title" : [ "t1", "t2", "t2" ], "type" : "suv" }
</code></pre>

<p>再向一个已经存在的键值非数组类型的键push一个值</p>

<pre><code>&gt; db.c.update({"name" : "toyota"},{$push:{"size.height":10}})
Cannot apply $push/$pushAll modifier to non-array
&gt; db.c.update({"name" : "toyota"},{$push:{"name":"ddddddd"}})
Cannot apply $push/$pushAll modifier to non-array
</code></pre>

<p>5.数组修改器–$ne/$addToSet</p>

<p>主要给数组类型键值添加一个元素时，避免在数组中产生重复数据，$ne在有些情况是不通行的。</p>

<pre><code>&gt; db.c.update({"title" : {$ne:"t2"}},{$push:{"title":"t2"}})
&gt; db.c.find()
{ "_id" : ObjectId("5003be465af21ff428dafbe7"), "name" : "toyota", "size" : { "height" : 8,
 "width" : 7, "length" : 15 }, "title" : [ "t1", "t2", "t2" ], "type" : "suv" }
&gt; db.c.update({"name" : "toyota"},{$addToSet:{"title":"t2"}})
&gt; db.c.find()
{ "_id" : ObjectId("5003be465af21ff428dafbe7"), "name" : "toyota", "size" : { "height" : 8,
 "width" : 7, "length" : 15 }, "title" : [ "t1", "t2", "t2" ], "type" : "suv" }
</code></pre>

<p>6.数组修改器–$pop、$pull</p>

<p>$pop从数组的头或者尾删除数组中的元素，</p>

<p>示例如下：</p>

<pre><code>{ "_id" : ObjectId("5003be465af21ff428dafbe7"), "name" : "toyota", "size" : { "height" : 8,  "width" : 7, "length" : 15 }, "title" : [ "t1", "t2", "t3", "t4" ],"type" : "suv" }
</code></pre>

<p>从数组的尾部删除 1</p>

<pre><code>&gt; db.c.update({"name" : "toyota"},{$pop:{"title":1}})
&gt; db.c.find()
{ "_id" : ObjectId("5003be465af21ff428dafbe7"), "name" : "toyota", "size" : { "height" : 8,
 "width" : 7, "length" : 15 }, "title" : [ "t1", "t2", "t3" ], "type" : "suv" }
</code></pre>

<p>从数组的头部 -1</p>

<pre><code>&gt; db.c.update({"name" : "toyota"},{$pop:{"title":-1}})
&gt; db.c.find()
{ "_id" : ObjectId("5003be465af21ff428dafbe7"), "name" : "toyota", "size" : { "height" : 8,
 "width" : 7, "length" : 15 }, "title" : [ "t2", "t3" ], "type" : "suv" }
</code></pre>

<p>从数组的尾部删除 0</p>

<pre><code>&gt; db.c.update({"name" : "toyota"},{$pop:{"title":0}})
&gt; db.c.find()
{ "_id" : ObjectId("5003be465af21ff428dafbe7"), "name" : "toyota", "size" : { "height" : 8,
 "width" : 7, "length" : 15 }, "title" : [ "t2" ], "type" : "suv" }
</code></pre>

<p>$pull从数组中删除满足条件的元素，示例如下：</p>

<pre><code>{ "_id" : ObjectId("5003be465af21ff428dafbe7"), "name" : "toyota", "size" : { "height" : 8,
 "width" : 7, "length" : 15 }, "title" : [ "t1", "t2", "t2", "t3" ],"type" : "suv" }
 
&gt; db.c.update({"name" : "toyota"},{$pull:{"title":"t2"}})
&gt; db.c.find()
{ "_id" : ObjectId("5003be465af21ff428dafbe7"), "name" : "toyota", "size" : { "height" : 8,
 "width" : 7, "length" : 15 }, "title" : [ "t1", "t3" ], "type" : "suv" }
</code></pre>

<p>7.数组的定位修改器</p>

<p>在需要对数组中的值进行操作的时候，可通过位置或者定位操作符（”$”)，数组是0开始的，可以直接将下标作为键来选择元素。<br />
使用$定位操作符时，若为多个文档满足条件，则只更新第一个文档。</p>

<p>示例如下：</p>

<pre><code>{"uid":"001",comments:[{"name":"t1","size":10},{"name":"t2","size":12}]}
&gt; db.c.find({"uid":"001"})
{ "_id" : ObjectId("5003da405af21ff428dafbe8"), "uid" : "001", "comments" : [ {
"name" : "t1", "size" : 10 }, { "name" : "t2", "size" : 12 } ] }
&gt; db.c.update({"uid":"001"},{$inc:{"comments.0.size":1}})
&gt; db.c.find({"uid":"001"})
{ "_id" : ObjectId("5003da405af21ff428dafbe8"), "uid" : "001", "comments" : [ {
"name" : "t1", "size" : 11 }, { "name" : "t2", "size" : 12 } ] }
&gt; db.c.update({"comments.name":"t1"},{$set:{"comments.$.size":1}})
&gt; db.c.find({"uid":"001"})
{ "_id" : ObjectId("5003da405af21ff428dafbe8"), "uid" : "001", "comments" : [ {
"name" : "t1", "size" : 1 }, { "name" : "t2", "size" : 12 } ] }
</code></pre>

<p>8.upsert</p>

<p>upsert是一种特殊的更新。当没有符合条件的文档，就以这个条件和更新文档为基础创建一个新的文档，如果找到匹配的文档就正常的更新。
使用upsert，既可以避免竞态问题，也可以减少代码量（update的第三个参数就表示这个upsert，参数为true时）</p>

<pre><code>&gt; db.c.remove()
&gt; db.c.update({"size":11},{$inc:{"size":3}})
&gt; db.c.find()
&gt; db.c.update({"size":11},{$inc:{"size":3}},false)
&gt; db.c.find()
&gt; db.c.update({"size":11},{$inc:{"size":3}},true)
&gt; db.c.find()
{ "_id" : ObjectId("5003ded6c28f67507a6df1de"), "size" : 14 }
</code></pre>

<p>9.save函数</p>

<p>1.可以在文档不存在的时候插入，存在的时候更新，只有一个参数文档。<br />
2.要是文档含有”_id”，会调用upsert。否则，会调用插入。</p>

<pre><code>&gt; db.a.find()
{ "_id" : ObjectId("50026affdeb4fa8d154f8572"), "desc" : "hello world1!", "num": 50,
 "sname" : "jk", "type" : "1", "uid" : "20120002" }
&gt; var o = db.a.findOne()
&gt; o.num = 55
55
&gt; db.a.save(o)
&gt; db.a.find()
{ "_id" : ObjectId("50026affdeb4fa8d154f8572"), "desc" : "hello world1!", "num": 55,
 "sname" : "jk", "type" : "1", "uid" : "20120002" }
</code></pre>

<hr />

<h4 id="section-5">索引管理</h4>

<ul>
  <li>
    <p>在字段firstname升序和lastname降序上创建一个名为idx_name的联合索引</p>

    <pre><code>  db.user.ensureIndex({"firstname":1, "lastname":-1}, {"name":"idx_name"})
</code></pre>
  </li>
  <li>
    <p>在username上创建一个唯一索引</p>

    <pre><code>  db.user.ensureIndex({"username":1}, {"unique":true});
</code></pre>
  </li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/11/shan-yong-xcode%2Cti-gao-kai-fa-xiao-lu/">善用Xcode，提高开发效率</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-11T21:53:08+08:00" pubdate data-updated="true">May 11<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>　　默认的xcode其实已经很强大的了，用起来已经很贴心舒服了，但它还可以更加强大的，以下介绍下我自己的一些增强技巧。</p>

<p>　　<strong>一、配色</strong><br />
　　要提高效率，首先得看着舒服，是吧。默认的白色，平常使用其实也挺不错的了，但时间用长了，还是感觉有一些不舒服，它最大的问题是色彩对比不明显，不容易定位到关键词上去。我差不多是使用默认配色一年多后，才打算改换主题的，后来在网上下了很多别人的主题，都发觉要么是对比度太强烈了，看着刺眼，或者太花哨，或者太死板，都有一些不喜欢的地方。后来找到了一个相对比较喜欢的主题，这个主题是仿sublime的一个主题<a href="https://github.com/colinta/zenburn">zenburn</a> ，但还是有一些不太喜欢的地方，后来花了一整个下午，根据它调了一个主题，包括字体、背景色、关键词颜色等等，算是比较满意了，<a href="https://github.com/makeLaugh/xcodeTheme">下载链接</a>在这里，喜欢的拿走。<br />
　　安装方式：下载后，将主题文件放入<code>/Users/HZD/Library/Developer/Xcode/UserData/FontAndColorThemes </code>目录中，重启<code>xcode即可</code>。我的环境是xcode5.1，其它的未测试。</p>

<p>    <strong>二、CocoaPods</strong><br />
    对CocoaPods的介绍和安装教程网太多了，随便百度谷歌一下都满大街了，我想说，如果还没有使用它来管理毓三方库的，那得切换了，因为它实在是太简单太高效了。下面简单罗列一下使用步骤。 <a href="http://code4app.com/article/cocoapods-install-usage">详细参考教程</a></p>

<p>    <strong>更换ruby源</strong>，以加快安装速度，如果已经更换过的跳过：</p>

<pre><code>1. gem sources --remove https://rubygems.org/
2. gem sources -a http://ruby.taobao.org/
3. gem sources -l //查看新的镜像源
</code></pre>

<p>    安装ruby，一般mac都自带了ruby，若未安装，可用以下方式安装或更新到最新版  </p>

<pre><code>1. 安装RVM：curl -L https://get.rvm.io | bash -s stable --ruby
2. 列出已知的ruby版本：rvm list known
3. 安装最新的版本：rvm install version号
4. 切换到安装的版本上：rvm use version号
5. rvm rubygems latest
</code></pre>

<p>    安装和使用CocoaPods</p>

<pre><code>1. 安装CocoaPods：sudo gem install cocoapods
2. 搜索要使用的库：pod search AFNetworking，会得到如何使用、源地址等提示
3. 编辑配置文件：vim Podfile
4. 按上术提示，添加相关配置，并保存  
   platform :ios, '7.0'  
   pod "AFNetworking", "~&gt; 2.0"
5. 安装第三方库：pod install 
6. 以后打开项目都打开`.xcworkspace`文件，而不是源来的项目文件。
</code></pre>

<p>    就这样，安装完成了，以后就可以使用AFNetworking了。
    一个技巧：有时候，第三方库会有警告，为了忽略警告，只需要在Podfile文件中添加一个命令即可，<code>inhibit_all_warnings!</code>。
    以下我的Podfile配置文件作为一个参考：  </p>

<pre><code>platform :ios, '7.0'
inhibit_all_warnings!
pod 'MKNetworkKit'
pod 'FMDB', '~&gt; 2.2'
pod 'REFrostedViewController', '~&gt; 2.4.5'
pod 'BlocksKit'
pod 'Overline-BlocksKit'
pod 'Masonry'
pod 'AFNetworking', '~&gt; 2.2.3'
pod 'UIColor+CSSColors', '~&gt; 0.0.1'
pod 'BlurryModalSegue', '~&gt; 1.0.0'
pod 'SBAPNSPusher', '~&gt; 2.2.1'!
</code></pre>

<p>    伏笔，CocoaPod其实有更便捷的管理方式，见以下插件部分。</p>

<p>    <strong>三、插件</strong><br />
    Xcode已经是一个非常强大的IDE了，但是，它还可以更强大，这就需要外挂了。<br />
    首先，安装插件管理器，当然你也可以手动来管理，但是强列推荐使用它<a href="https://github.com/supermarin/Alcatraz"><strong>Alcatraz</strong></a>，有了它，你的xcode将无所不能，且极其的方便管理插件，安装卸载，一键搞定。详细教程，点开链接后仔细阅读吧，以下简单说明安装和卸载：<br />
    <strong>安装</strong>：curl -fsSL https://raw.github.com/supermarin/Alcatraz/master/Scripts/install.sh | sh<br />
    或者下载源码编译即可<br />
    <strong>重启xcode</strong>，即可安装好<br />
    <strong>卸载</strong>：我还没有卸载过，你要不喜欢，运行下面的命令吧  </p>

<pre><code>卸载Alcatraz: rm -rf ~/Library/Application\ Support/Developer/Shared/Xcode/Plug-ins/Alcatraz.xcplugin
卸载通过它安装的插件: rm -rf ~/Library/Application\ Support/Alcatraz/
</code></pre>

<p>    启动Alcatraz：<code>command+shift+9</code>或者window-&gt;Package Manager<br />
    它有四个菜单，分别为<strong>All 插件  主题  模板</strong>，点击单个插件前面的小图标时，会自动安装，安装成功后，注意看图标，变成了淡蓝色(注意睁大眼睛看)，卸载再点一次即可，更新再点一次就是更新了。</p>

<p>    网上已经有了各种排名的xcode的十大插件、十五大插件的，试用了一下，下面简单介绍几个个人使用后，觉得挺不错的插件：  </p>

<p>    1.<strong>CocoaPods</strong><br />
    不喜欢使用命令行？没关系，装上这个插件，在Product选项里，就集成了CocoaPods选项了，直接点击就可以在Xcode里管理CocoaPods里的第三方库了。<br />
    <img src="https://github.com/kattrali/cocoadocs-xcode-plugin/raw/master/menu.png" alt="image" /></p>

<p>    2.<strong>ColorSense</strong><br />
    是不是每次设置颜色的时候，不知道效果？用它吧，直接在代码里修改颜色，如下图：<br />
    <img src="/images/blog/2014/Xcode效率/ColorSense.png" alt="image" /></p>

<p>    3.<strong>VVDocumenter</strong><br />
    注释对于代码很重要，特别是对代码规范要求很严的公司，那更是必须写的，话说，自己写，有一个好的规范不也挺好的么，这个配合<code>appledoc</code>一起工作，简直是神器，下面有介绍。这货可以让你在写注释的时候，大幅的降低繁杂重复的工作量。见下图：<br />
    <img src="https://raw.github.com/onevcat/VVDocumenter-Xcode/master/ScreenShot.gif" alt="image" /></p>

<p>    4.<strong>FuzzyAutocomplete</strong><br />
    xcode自带的自动代码匹配功能不是很完善，当你只大概记得一个方法时，这时候，xcode就无能为力了，它登场了，效果见下图：<br />
    <img src="https://github.com/FuzzyAutocomplete/FuzzyAutocompletePlugin/raw/master/demo.gif" alt="image" /></p>

<p>    5.<strong>XAlign</strong><br />
    你有没有一个空格一个空格的敲，就为了对齐那该死的<code>@、=、*</code>等符号？好吧，如果你没有，那说明你没有代码洁癖，我应该恭喜你呢，还是替后来维护的人难受？<br />
    <img src="https://camo.githubusercontent.com/7973c0e352b1f91e3efe5b3550cff5df97f4589a/687474703a2f2f7166692e73682f58416c69676e2f696d616765732f657175616c2e676966" alt="image" /><br />
    <img src="https://camo.githubusercontent.com/f61bfc31e144ad6a9d7ca26fa19547a3af5da8c6/687474703a2f2f7166692e73682f58416c69676e2f696d616765732f646566696e652e676966" alt="image" /></p>

<p>    6.<strong>BBUDebuggerTuckAway</strong><br />
    xcode很强大，但有的时候，它却不太讨人喜欢，我明明在编写代码了，调试窗口却死活不肯退场，死占着那个位置，让我多难受啊。控制台，我开始写代码了，你去睡一会儿吧。<br />
    <img src="http://cms.csdnimg.cn/article/201405/05/53674c667516f.jpg" alt="image" /></p>

<p>    7.<strong>XcodeBoost</strong><br />
    它的使用有一点小复杂，你需要花一点时间去熟悉它，了解它，别恐惧，其实也没有那么复杂了，它真的很强大，真的非常的强大，有图有真相<br />
    <img src="https://github.com/fortinmike/XcodeBoost/raw/master/Images/highlighting.gif" alt="image" /><br />
    <img src="https://github.com/fortinmike/XcodeBoost/raw/master/Images/copy-method-declarations.gif" alt="image" /><br />
    <img src="https://github.com/fortinmike/XcodeBoost/raw/master/Images/paste-without-reindent.gif" alt="image" /><br />
    
    8.<strong>KSImagedNamed</strong>
    当我第一次看到它的时候，我内牛满面，我为什么不早点认识它呢，以前在代码里设置图片，不知道图片是什么样子，也不知道图片是什么名字的时候，在UI给我的图片包里，一个一个去找的时候，我有想疯了的感觉。这货不但可以自动匹配识别图片名字，还能预览图片，你还有什么理由不使用它呢？<br />
    <img src="http://cms.csdnimg.cn/article/201405/05/53673f77a65a3.jpg" alt="image" />    </p>

<p>    以上是我使用过后，感觉非常不错，能够极大提高效率的几个插件，以后有新的体验了，还会更新，这些插件都可以直接通过<code>Alcatraz</code>来管理，所以不上链接了。另声明：以上截图大部分来源于原作者网站。</p>

<p>    <strong>四、文档生成工具Appledoc</strong><br />
    前面介绍了<code>VVDocumenter</code>，终于轮到它登场了，使用<code>VVDocumenter</code>写上标准的注释，然后使用appledoc，一键生成苹果官方式的文档，如下图所示：<br />
	<img src="images/blog/2014/Xcode效率/appledoc1.png" alt="image" />  </p>

<p>    首先安装，可以选择正常安装，也可以选择homebrew安装。<br />
    <strong>正常安装</strong>：  </p>

<pre><code>1. git clone git://github.com/tomaz/appledoc.git
2. cd ./appledoc
3. sudo sh install-appledoc.sh
</code></pre>

<p>    <strong>homeBrew安装</strong>：  </p>

<pre><code>brew install appledoc
</code></pre>

<p>    <strong>使用：</strong>  </p>

<pre><code>1. cd 项目目录
2. appledoc -o ./doc --project-name MyProject --project-company MyCompany --company-id companyId .
</code></pre>

<p>    首先进入项目目录，然后运行上面的命令，<code>MyProject</code>是你项目的名字，<code>MyCompany</code>是你公司的名字，最后<code>./doc</code>是指在当前目录下，生成一个doc目录，里面有一个<code>docset-installed.txt</code>文件，里面记录你安装的记录和文档生成的路径，<code>companyId</code>一般写成<code>com.company</code>格式。<br />
    appledoc支持markdown、html等语言来写注释，详细的介绍推荐看<a href="http://blog.ibireme.com/2013/08/26/appledoc-guide/">这篇文章</a></p>

<p>    <strong>总结：</strong><br />
    Xcode虽然是苹果一家开发维护，封闭的，但是在配合一些其它的工具，还是可以极大的提高我们的开发效率，工欲善其事，必先利其器，好好的挖掘它的潜力，为我们服务！</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/09/20/shi-yong-podsguan-li-xiang-mu/">使用pods管理项目</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/03/19/yii2ipbnote/">Yii2学习笔记</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/03/02/2015/">2015，新的一年，加油！</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/02/11/macxia-pei-zhi-nginx-plus-php-plus-mongohuan-jing/">mac下配置nginx+php+mongo环境</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/02/11/macxia-pei-zhi-webhuan-jing/">mac下配置web环境</a>
      </li>
    
  </ul>
</section>




<aside>
	<h3>About Bill <img src="/images/branding/avatar.png" class="left" style="padding-right: 10px;" /></h3>
	<p>
		I&#8217;m Bill Patrianakos. I created <a href="https://writeapp.me">Write.app</a>, founded  <a href="https://chooseclever.com">Clever Web Design</a>, and  work as a web developer in Chicago.
		<br />
		<a class="button" href="">Related Stuff <i class="icon-circle-arrow-down"></i></a>
	</p>
</aside>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - laughmaker -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | Themed with <a href="https://github.com/lucaslew/whitespace">Whitespace</a></span>
</p>

</footer>
  














</body>
</html>
